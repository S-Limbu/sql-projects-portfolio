- 🧠 Problem / Business Scenario : You're a growth analyst at a digital e-commerce company. Your marketing team runs 
campaigns across multiple channels: Organic, Paid Ads, Email, etc. They want to analyze which channel drives the most 
revenue, not just traffic.

- 📚 Concepts: JOIN + SUM + GROUP BY + ORDER BY

- 💡 Why this matters: 
  - Helps the team understand which marketing channels are actually generating revenue—not just users.
  - Knowing which channels convert best enables more precise targeting and segmentation.
  - Based on results, the company can double down on high-performing channels and cut spend from underperformers.

-- 🔄 1. Drop existing table to avoid conflicts

DROP TABLE IF EXISTS users, purchases;


-- 🧱 2. Create the table schema

CREATE TABLE users (
  user_id INT,
  source TEXT
);

CREATE TABLE purchases (
  purchase_id INT,
  user_id INT,
  amount DECIMAL
);

-- 📊 3. Insert sample/mock data

INSERT INTO users VALUES
(1, 'Organic'), (2, 'Ads'), (3, 'Email');

INSERT INTO purchases VALUES
(1, 1, 100), (2, 2, 150), (3, 3, 50), (4, 4, 120), (5, 4, 150), (6, 4, 80), (7, 4, 75), (8, 4, 90)
, (9, 2, 50), (10, 2, 200), (11, 3, 50), (12, 1, 40), (13, 1, 50), (14, 4, 30), (15, 1, 50);

-- 🔍 4. Final query

SELECT 
u.source,
SUM(p.amount) AS total_revenue 
FROM purchases p
JOIN users u ON p.user_id = u.user_id
GROUP BY u.source
ORDER BY total_revenue DESC;

-- 🖼️ Screenshot: screenshots/23-revenue-by-marketing-source-result.png
-- 📝 Output: Shows which marketing campaing cultivates the most true revenue.
